
{% extends 'base.html' %}
{% load static %}
{% block content %}
<!-- start banner Area -->
<section class="banner-area organic-breadcrumb">
	<div class="container">
		<div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
			<div class="col-first">
				<h1>Checkout</h1>
				<nav class="d-flex align-items-center">
<!--						<a href="index.html">Home<span class="lnr lnr-arrow-right"></span></a>-->
					<a href="category.html"></a>
				</nav>
			</div>
		</div>
	</div>
</section>
<!-- End banner Area -->
    <!--================Checkout Area =================-->
    <section class="checkout_area section_gap">
        <div class="container">
            <div style="display: flex;justify-content: center;">
           <h2 style="font-family:sans-serif;font-weight:bold;">Place your Order</h2>
            </div>
            <div class="billing_details">

                <form action="#" method="post" id="myform">
                <div class="row">
                    <div class="col-lg-8">                
                        <div class="row contact_form" >
                            {% for i in address %}
                            <div style="width:800px;height:450px;background-color: rgba(189, 205, 205, 0.404);">
                                <h3 style="font-weight:bold;margin-top:25px;margin-left:100px;">Shipping Address</h3> 
                            <div style="margin-left:100px;background-color:rgba(102, 99, 110, 0.155);width:400px">
                                <table style="margin-left:20px;">
                                    <tr ><td><h4 style="color:red;font-weight:bold;">{{i.fname}}</h4></td><td><h4 style="color:red;font-weight:bold;"> {{i.lname}}</h4></td></tr> </table>
                                   <table style="margin-left:20px;">
                                    <tr><td><h4>Number:</h4></td><td><h4>{{i.phone_no}}</h4></td></tr>
                                    <tr><td><h4>Email:</h4></td><td><h4>{{i.email}}</h4></td></tr>
                                    <tr><td><h4>House:</h4></td><td><h4>{{i.hname}}</h4></td></tr>
                                    <tr><td><h4>Street:</h4></td><td><h4>{{i.street}}</h4></td></tr>
                                    <tr><td><h4>City:</h4></td><td><h4>{{i.city}}</h4></td></tr>
                                    <tr><td><h4>District:</h4></td><td><h4>{{i.district}}</h4></td></tr>
                                    <tr><td><h4>Pin:</h4></td><td><h4>{{i.pin}}</h4></td></tr>
                                </table> 
                            </div>
                            </div>                            
                            {% endfor %}  
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="order_box">
                            <h2>Order Summary</h2>
                            <ul class="list">
                                <li><a href="#">Product <span>Total</span></a></li>
                                {% for i in item %}
                                <li><a href="#">{{i.product.name}} <span class="middle">x {{i.product_qty}}</span> <span class="last">₹{{i.price}}</span></a></li>
                                {% endfor %}
                            </ul>
                            <ul class="list list_2">
                               
                                <li><a href="#">Total <span>₹{{total}}</span></a></li>
                            </ul>
                            <button id="rzp-button1" type="button" class="btn btn-primary w-100 mt-2">Pay with Razorpay</button>
                        </div>
                    </div>
                </div>
            </form>  
            <script>
                var options = {
                    "key": 'rzp_test_VkGzssC2F5AiRN', // Enter the Key ID generated from the Dashboard
                    "amount": "{{stotal}}", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
                    "currency": "INR",
                    "name": "Smart-Store",
                    "description": "Test Transaction",
                    "image": "https://example.com/your_logo",
                    "order_id": "{{order_id}}", //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
                    "handler": function (response){
                        console.log("success")
                        var form = document.getElementById["myform"];
                        var a = response.razorpay_payment_id;
                        window.location.href = 'http://127.0.0.1:8000/paymentdone?order_id=${response.razorpay_order_id}&cust_id=${response.customer}&payment_id='+a

                    },
                    "theme": {
                        "color": "#3399cc"
                    }
                };
                var rzp1 = new Razorpay(options);
                rzp1.on('payment.failed', function (response){
                        alert(response.error.description);
                });
                document.getElementById('rzp-button1').onclick = function(e){
                    console.log("button click");
                    rzp1.open();
                    e.preventDefault();
                }
                </script>
            
            </div>
        </div>
    </section>
    <!--================End Checkout Area =================-->
{% endblock %}